<!-- index.html (canonical now-playing UI) -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Now Playing</title>
  <style>html,body{background:#000;color:#fff;}</style>
  <script>
    // Fallbacks for embedded preview mode.
    window.addEventListener('DOMContentLoaded', () => {
      try {
        const embedded = (window.top !== window.self);
        if (embedded) {
          const host = location.hostname || '10.0.0.233';
          const proto = location.protocol || 'http:';
          const b = document.body;
          const c = document.getElementById('content');
          const bgA = document.getElementById('background-a');
          const bgB = document.getElementById('background-b');

          // Ensure background layers are actually visible in iframe context.
          if (b) b.style.background = 'transparent';
          if (c) { c.style.position = 'relative'; c.style.zIndex = '1'; }
          if (bgA) { bgA.style.zIndex = '0'; bgA.style.opacity = '1'; }
          if (bgB) { bgB.style.zIndex = '0'; bgB.style.opacity = '0'; }

          // Use current art and let CSS blur/filter create the backdrop.
          if (bgA && !bgA.style.backgroundImage) {
            bgA.style.backgroundImage = `url(${proto}//${host}:3101/art/current.jpg?t=${Date.now()})`;
          }
        }
      } catch (_) {}

      // If boot JS errors, don't leave preview on a blank/white boot screen.
      setTimeout(() => {
        try {
          const b = document.body;
          if (b && b.classList.contains('booting')) {
            b.classList.remove('booting');
            b.classList.add('ready');
          }
        } catch (_) {}
      }, 1800);
    });
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles/index1080.css?v=20260219-7" />

</head>

<body class="booting">
  <div id="background-a"></div>
  <div id="background-b"></div>

  <div id="content">
    <!-- Album Art -->
    <div id="album-art-wrapper" role="group" aria-label="Album art and controls">
      <div id="album-art-bg"></div>

      <!-- Album artwork (does NOT open modal) -->
      <img
        id="album-art"
        src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
        alt="Album Art"
        draggable="false"
      />
      <video id="album-art-video" muted loop playsinline preload="metadata" style="display:none;"></video>

      <!-- Personnel hotspot (ONLY this opens the modal) -->
      <button
        id="art-info-hotspot"
        class="art-hotspot"
        type="button"
        aria-label="Show personnel"
        title="Show personnel"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M11 10h2v7h-2v-7zm0-3h2v2h-2V7zm1 15C6.935 22 3 18.065 3 13S6.935 4 12 4s9 3.935 9 9-3.935 9-9 9zm0-2c3.859 0 7-3.141 7-7s-3.141-7-7-7-7 3.141-7 7 3.141 7 7 7z"/>
        </svg>
      </button>

      <!-- Favorites heart (should NOT trigger modal) -->
      <button
        id="fav-heart"
        type="button"
        aria-label="Toggle favorite"
        title="Toggle favorite"
      >
        <svg viewBox="0 0 24 24" shape-rendering="geometricPrecision" aria-hidden="true" focusable="false">
          <path d="M12 21
                   C12 21 3 14.5 3 8.5
                   C3 6 5 4 7.5 4
                   C9.24 4 10.91 5 12 6.44
                   C13.09 5 14.76 4 16.5 4
                   C19 4 21 6 21 8.5
                   C21 14.5 12 21 12 21Z"/>
        </svg>
      </button>
    </div>

    <!-- Text -->
    <div class="text-column">
      <div id="artist-name"></div>

      <div id="titleLine">
        <span id="track-title"></span>
        <span id="ratingStars" class="rating-stars"></span>
      </div>

      <!-- Album + share icon live entirely inside this link -->
      <a id="album-link" aria-label="Open in Apple Music">
        <span id="album-text"></span>
      </a>

      <div id="file-info">
        <span id="file-info-text"></span>
        <span id="hires-badge" class="hires-badge">Lossless</span>
        <span id="mode-status"></span>
      </div>

      <div id="personnel-info"></div>

      <div id="next-up">
        <img id="next-up-img" alt="">
        <span id="next-up-text">
          <span class="marquee-track">
            <span class="marquee-copy"></span>
            <span class="marquee-copy"></span>
          </span>
        </span>
      </div>

      <div id="progress-bar-wrapper">
        <div id="progress-fill"></div>
      </div>

      <img id="mode-logo" alt="">
    </div>
  </div>

  <div id="artist-details-container">
    <div id="artist-details"></div>
  </div>

  <!-- Phone controls -->
  <div id="phone-controls" aria-label="Playback controls">
    <button class="ctl" id="btn-prev" aria-label="Previous" title="Previous" type="button">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M6 5h2v14H6V5zm3.5 7 10-7v14l-10-7z"/>
      </svg>
    </button>

    <button class="ctl big" id="btn-play" aria-label="Play/Pause" title="Play/Pause" type="button">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path id="playIcon" d="M8 5v14l11-7z"/>
      </svg>
    </button>

    <button class="ctl" id="btn-next" aria-label="Next" title="Next" type="button">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M16 5h2v14h-2V5zM4.5 19V5l10 7-10 7z"/>
      </svg>
    </button>
  </div>
    <!-- Modal -->
  <div class="modalOverlay" id="modalOverlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <div class="modalHead">
        <img class="thumb" id="modalThumb" src="" alt="" />
        <div class="modalTitleWrap">
          <div class="modalTitle" id="modalTitle">Podcast</div>
          <div class="modalSub" id="modalSub"></div>
        </div>
        <button class="modalClose" id="modalClose" aria-label="Close">✕</button>
      </div>

      <div class="modalBody">
        <div class="tinyMuted" id="modalHint">Loading…</div>
        <div class="epList" id="epList" style="margin-top:10px;"></div>
      </div>

      <div class="modalActions">
        <div class="tinyMuted" id="modalCount"></div>
        <div style="display:flex; gap:10px;">
          <button class="btn" id="modalRefresh">Refresh</button>
          <button class="btn btnDanger" id="modalDeleteSelected" disabled title="Not wired yet">Delete selected</button>
        </div>
      </div>
    </div>
  </div>

    <script src="scripts/index.js"></script>


  <script src="scripts/index-ui.js?v=20260220-115"></script>
</body>
</html>